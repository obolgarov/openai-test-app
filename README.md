# Running

This project is a separate client and server running through
[Deno](https://deno.com/).

First install Deno:

```sh
curl -fsSL https://deno.land/install.sh | sh
```

Create the environment files for the client and server. Copy the examples in
`api/.env.example` and `app/.env.example` to `api/.env` and `app/.env`
respectively, and fill in the values.

Run the following commands to start the client and server (done in different
shell sessions)

Server:

```sh
# Server, from the root directory
cd api
deno run dev
```

Client:

```sh
# Client, from the root directory
cd app
deno run start
```

# Premise

This is just a demo project to try out some random tech and learn a few things.
For this particular project, my initial goal was to set up a simple AI-based
chat bot website, so I could put "AI" on my resume.

New stuff I tried out:

- Deno
- Oak (update: now using Hono)
- Multi-issuer OAuth2 authentication (Google, Github, Facebook)
- Redis for caching
- AI chatbot (OpenAI, Github Copilot)
- Fresh
- Preact (pretty much just like React, but with "Signals")

This project isn't meant to be best way to architect a project, but to practice
certain tools and techniques. Though I tried my best to make the project well
architected, but I doubt it's up to enterprise standards.

# Generating API Types for the client

The server and client are separated and have no imports between each other, so
the server can't tell the client what it's API looks like during build time,
including what types it has. So as a workaround, we have a standard system
called OpenAPI as a protocol for the API specifications that the client can use,
with the specifications are generated by the server. This is currently done
using [`hono-openapi`](https://hono.dev/examples/hono-openapi) to allow Hono to
generate an openAPI spec from the existing API interface defined by
[`zod`](https://zod.dev/) schemas.

The client will be able to use these specifications to generate Typescript types
for it's API queries, making it easy to manage safe typing between client and
server. This is done with
[`openapi-typescript`](https://openapi-ts.dev/introduction).

Putting these together, first the server should be running for the openAPI spec
endpoint to be available, then `openapi-typescript` will run on the endpoint and
output a typescript file that would be imported for client API queries. A script
to generate the client types is present in
`/app/src/scripts/generate-openapi-types.sh`, and can be run with a deno task
`generate-openapi-types` in `/app/deno.json`:

1. Run the server if not running already:

```sh
# from the root directory
cd api
deno run dev
```

2. Run the deno task in `/app`:

```sh
# from the root directory
cd app
deno run generate-openapi-types
```

The generated typescript file should be found in
`/app/src/types/api-types.d.ts`.
